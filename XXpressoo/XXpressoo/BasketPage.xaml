<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://xamarin.com/schemas/2014/forms"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="XXpressoo.BasketPage">

    <!-- Стили -->
    <ContentPage.Resources>
        <Style TargetType="Button" x:Key="QuantityButtonStyle">
            <Setter Property="WidthRequest" Value="40"/>
            <Setter Property="HeightRequest" Value="40"/>
            <Setter Property="FontSize" Value="20"/>
            <Setter Property="BackgroundColor" Value="#E0E0E0"/>
            <Setter Property="TextColor" Value="Black"/>
        </Style>

        <Style TargetType="Label" x:Key="ProductTitleStyle">
            <Setter Property="FontSize" Value="16"/>
            <Setter Property="TextColor" Value="#333333"/>
            <Setter Property="VerticalOptions" Value="Center"/>
        </Style>

        <Style TargetType="Label" x:Key="ProductPriceStyle">
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="TextColor" Value="#9E9E9E"/>
        </Style>
    </ContentPage.Resources>

    <!-- Grid для размещения списка и нижней панели -->
    <Grid RowDefinitions="*, Auto" 
          RowSpacing="0"
          Padding="0"
          Margin="0">

        <!-- Основной контент -->
        <StackLayout Grid.Row="0" Padding="20">

            <!-- Заголовок -->
            <Label Text="Ваша корзина" FontSize="24" FontAttributes="Bold" HorizontalOptions="Center"/>

            <!-- Список товаров -->
            <ListView x:Name="lstBasket" 
                      ItemsSource="{Binding}" 
                      HasUnevenRows="True"
                      Margin="0,20,0,0"
                      SeparatorVisibility="None">

                <ListView.ItemTemplate>
                    <DataTemplate>
                        <ViewCell>
                            <Frame BackgroundColor="White" CornerRadius="10" Padding="10" Margin="0,5">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>

                                    <!-- Изображение -->
                                    <Image Source="{Binding ImageUrl}" 
                                           WidthRequest="60" 
                                           HeightRequest="60"
                                           Grid.Column="0"
                                           VerticalOptions="Start"/>

                                    <!-- Название + Цена -->
                                    <StackLayout Grid.Column="1" VerticalOptions="Center" Spacing="5">
                                        <Label Text="{Binding ProductName}" Style="{StaticResource ProductTitleStyle}"/>
                                        <Label Text="{Binding Price, StringFormat='{0} руб.'}" Style="{StaticResource ProductPriceStyle}"/>
                                    </StackLayout>

                                    <!-- Управление количеством -->
                                    <StackLayout Grid.Column="2" Orientation="Horizontal" HorizontalOptions="End">
                                        <Button Text="-" 
                                                CommandParameter="{Binding ProductId}"
                                                Clicked="OnMinusClicked"
                                                Style="{StaticResource QuantityButtonStyle}"/>
                                        <Label Text="{Binding Quantity}" 
                                               VerticalOptions="Center"
                                               HorizontalOptions="Center"
                                               WidthRequest="30"
                                               FontSize="16"/>
                                        <Button Text="+" 
                                                CommandParameter="{Binding ProductId}"
                                                Clicked="OnPlusClicked"
                                                Style="{StaticResource QuantityButtonStyle}"/>
                                    </StackLayout>
                                </Grid>
                            </Frame>
                        </ViewCell>
                    </DataTemplate>
                </ListView.ItemTemplate>
            </ListView>

            <!-- Кнопка оформления заказа -->
            <Button Text="Оформить заказ"
                    BackgroundColor="#FFA726"
                    TextColor="White"
                    CornerRadius="20"
                    Margin="0,20,0,0"
                    HeightRequest="45"
                    Clicked="OnCheckoutClicked"/>
        </StackLayout>

        <!-- Нижняя панель с иконками -->
        <Frame Grid.Row="1"
               BackgroundColor="White"
               HasShadow="True"
               CornerRadius="10"
               HeightRequest="70"
               VerticalOptions="End"
               HorizontalOptions="FillAndExpand"
               Margin="0"
               Padding="0"
               BorderColor="#EEE"/>

        <Frame Grid.Row="1"
        BackgroundColor="White"
        HasShadow="True"
        CornerRadius="10"
        HeightRequest="70"
        VerticalOptions="End"
        HorizontalOptions="FillAndExpand"
        Margin="0"
        Padding="0"
        BorderColor="#EEE"/>

        <StackLayout Grid.Row="1"
              Orientation="Horizontal"
              Spacing="0"
              BackgroundColor="Transparent"
              VerticalOptions="End"
              HorizontalOptions="FillAndExpand"
              Padding="0"
              Margin="0,0,0,5">

            <!-- Иконка "Главная" -->
            <ImageButton Source="https://cdn-icons-png.flaticon.com/128/7133/7133312.png"
                   WidthRequest="50"
                   HeightRequest="50"
                   HorizontalOptions="CenterAndExpand"
                   VerticalOptions="Center"
                   BackgroundColor="Transparent"
                   Clicked="ImageButton_Clicked"/>

            <!-- Иконка "Меню" -->
            <ImageButton Source="https://cdn-icons-png.flaticon.com/128/747/747327.png"
                   WidthRequest="40"
                   HeightRequest="40"
                   HorizontalOptions="CenterAndExpand"
                   VerticalOptions="Center"
                   BackgroundColor="Transparent"
                   Clicked="OnMenuClicked"/>

            <!-- Иконка "Заказ" (центральная) -->
            <ImageButton Source="https://cdn-icons-png.flaticon.com/128/1008/1008010.png"
                   WidthRequest="60"
                   HeightRequest="60"
                   HorizontalOptions="CenterAndExpand"
                   VerticalOptions="Center"
                   BackgroundColor="#E53935"
                   CornerRadius="15"
                   Margin="0,-10,0,0"
                  Padding="10"
                   Clicked="OnOrderClicked"/>

            <!-- Иконка "Профиль" -->
            <ImageButton Source="https://cdn-icons-png.flaticon.com/128/1144/1144760.png"
                   WidthRequest="40"
                   HeightRequest="40"
                   HorizontalOptions="CenterAndExpand"
                   VerticalOptions="Center"
                   BackgroundColor="Transparent"
                   Clicked="OnProfileClicked"/>

            <!-- Иконка "Корзина" -->
            <ImageButton Source="https://cdn-icons-png.flaticon.com/128/711/711897.png"
                   WidthRequest="40"
                   HeightRequest="40"
                   HorizontalOptions="CenterAndExpand"
                   VerticalOptions="Center"
                   BackgroundColor="Transparent"
                   Clicked="OnCartClicked"/>
        </StackLayout>
    </Grid>
</ContentPage>